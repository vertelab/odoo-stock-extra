<?xml version="1.0"?>
<odoo>
    
        <record id="cavarosa_delivery_cost_import_form" model="ir.ui.view">
            <field name="name">cavarosa.delivery.cost.import.form</field>
            <field name="model">cavarosa.delivery.cost.import</field>
            <!-- <field name="type">form</field> -->
            <field name="arch" type="xml">
                <form string="Cavarosa Delivery Cost Import">
                    <!-- <sheet string="Cavarosa Delivery Cost Import">
                        <h1>Cavarosa Delivery Cost Import</h1> -->
                     <group>
                        <field name="data"/> 
                       <field name="carrier_id" invisible="1"/>
                    </group> 
                    <!-- </sheet> -->
                    <footer>
                        <button name="import_costs" type="object" string="Import" class="oe_highlight"/>

                        <!-- or -->
                        <button string="Cancel" class="oe_link" special="cancel" />
                    </footer>
                </form>
            </field>
        </record>

        <act_window name="Import post code"
            res_model="cavarosa.delivery.cost.import"
            binding_model="delivery.carrier"
            binding_views="list"
            view_mode="form" target="new" 
            id="act_cavarosa_home_delivery" />

        <record id="delivery_carrier_form" model="ir.ui.view">
            <field name="name">delivery.carrier.postcode.wizard</field>
            <field name="priority" eval="1" />
            <field name="model">delivery.carrier</field>
            <field name="inherit_id" ref="delivery.view_delivery_carrier_form" />
            <field name="arch" type="xml">
              <group name="zip_to" position="after">
                <group name="postcode_ids">
                    <field name="postcode_ids" widget="many2many_tags"/>
                </group>
                         
              </group>

            </field>
        </record>
       
       <!-- Turn off delivery options under certain circumstances, such as when zip code is not present in register. -->
       <template id="payment_delivery_zip_code_comparison" name="Delivery Costs Zip Code Comparison" inherit_id="website_sale_delivery.payment_delivery">

        <xpath expr="//li[@class='list-group-item o_delivery_carrier_select']" position="attributes">
	    <attribute name="t-if">
		not delivery.postcode_ids or ''.join(order.partner_shipping_id.zip.split()) in delivery.mapped('postcode_ids.name')
	    </attribute>
        </xpath>
        <xpath expr="//li[@class='list-group-item o_delivery_carrier_select']" position="after">
	    <t t-if ="delivery.postcode_ids and ''.join(order.partner_shipping_id.zip.split()) not in delivery.mapped('postcode_ids.name')">
	        <li class="list-group-item o_delivery_carrier_select">
		    <div style="display:flex; justify-content:space-between;">
			<p> Hemleverans </p>
			<p> Ej tillgängligt för ditt postnummer. </p>
		    </div>
		</li>
	    </t>
        </xpath>

        <xpath expr="//t[@t-call='website_sale_delivery.payment_delivery_methods']" position="replace">
	    <t t-if="delivery.postcode_ids and ''.join(order.partner_shipping_id.zip.split()) not in delivery.mapped('postcode_ids.name') ">
		<t t-call="website_sale_delivery.payment_delivery_methods"/>
	    </t>
	    <t t-else="">
		<div style="display:flex; justify-content:space-between;">
		    <p> Hemleverans </p>
		    <p> Ej tillgängligt för ditt postnummer. </p>
		</div>
	   </t>
        </xpath>
        <!--  we shouldn't be able to pay if there is no way to deliver -->
        <xpath expr="//div[@id='payment_method']" position="attributes">
                <attribute name="t-att-style">'display: none!important' if not deliveries and delivery_has_storable else ''</attribute>
        </xpath>
    </template>

            
</odoo>
