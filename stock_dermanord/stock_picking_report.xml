<?xml version="1.0" encoding="UTF-8"?>
<openerp>
   <data>
      <template id="picking_operations_document" inherit_id="stock_multiple_picker.picking_operations_document">
         <xpath expr="(//table[@t-if='o.pack_operation_ids']/thead/tr/th[@class='text-right'])[2]" position="after">
            <th class="text-center">
               <strong>Comment</strong>
            </th>
         </xpath>
         <xpath expr="(//table[@t-if='o.pack_operation_ids']/tbody/tr/td[@class='text-right'])[2]" position="after">
            <td>
               <span t-field="pack_operation.product_id.picking_comment" />
            </td>
         </xpath>
         <xpath expr="//table[@t-if='not o.pack_operation_ids']/thead/tr/th[last()]" position="after">
            <th>
               <strong>Comment</strong>
            </th>
         </xpath>
         <xpath expr="//table[@t-if='not o.pack_operation_ids']/tbody/tr/t/t/t/td[last()]" position="after">
            <!--   <td>
                    <span t-field="move.product_id.picking_comment"/>
                </td> -->
            <td>
               <t t-if="not move_last">
                  <t t-if="not move.is_offer">
                     <t t-if="o.move_lines.sorted(key=lambda r: r.quant_source_location)[move_index+1].is_offer">
                        <span t-esc="o.move_lines.sorted(key=lambda r: r.quant_source_location)[move_index+1].product_id.picking_comment" />
                     </t>
                     <t t-if="not o.move_lines.sorted(key=lambda r: r.quant_source_location)[move_index+1].is_offer">
                        <span t-field="move.product_id.picking_comment" />
                     </t>
                  </t>
               </t>
               <t t-if="move_last">
                  <span t-field="move.product_id.picking_comment" />
               </t>
            </td>
         </xpath>
      </template>
   </data>
</openerp>

